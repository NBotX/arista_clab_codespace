name: arista_clab_basic
prefix: ""

mgmt:
  network: custom-mgmt-net
  mtu: 1500
  ipv4-subnet: 172.100.100.0/24
  ipv4-range: 172.100.100.128/25

topology:
  kinds:
    arista_ceos:
      image: "ceos:4.32.0F"
  nodes:
    eos1:
      kind: arista_ceos
      startup-config: configs/eos1-startup-config
      ports:
        - 8080:22
    eos2:
      kind: arista_ceos
      startup-config: configs/eos2-startup-config
      ports:
        - 8081:22
    netauto-box:
      kind: linux
      ports:
        - 8082:22
      image: python:3.11-slim
      binds:
        - scripts:/scripts
      exec:
        - bash -c "pip install --default-timeout=100 -r scripts/requirements.txt"

    sshx:
      kind: linux
      image: ghcr.io/srl-labs/network-multitool
      exec:
        - >-
          ash -c "curl -sSf https://sshx.io/get | sh > /dev/null ;
          sshx -q --enable-readers > /tmp/sshx &
          while [ ! -s /tmp/sshx ]; do sleep 1; done && cat /tmp/sshx"

  links:
    - endpoints: ["eos1:eth1", "eos2:eth1"]

